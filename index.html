<script src="lib/blockly_compressed.js"></script>
<script src="lib/blocks_compressed.js"></script>
<script src="lib/javascript_compressed.js"></script>
<script src="lib/en.js"></script>
<script src="api.js"></script>
<script src="blocks.js"></script>

<head>
	<meta charset=utf-8>
	<title>My first three.js app</title>
	<style>
		body { margin: 0; }
		canvas { width: 100%; height: 100% }
	</style>
</head>

<div id="blocklyDiv" style="height: 480px; width: 600px; position: fixed; opacity: 0.8;"></div>

<xml id="toolbox" style="display: none">
	<block type="Cube"></block>
	<block type="controls_if"></block>
	<block type="controls_repeat_ext"></block>
	<block type="logic_compare"></block>
	<block type="math_number"></block>
	<block type="math_arithmetic"></block>
	<block type="text"></block>
	<block type="text_print"></block>
  </xml>

<script src="lib/three.min.js"></script>
<script src="graphics.js"></script>
<script>
	var scene = new THREE.Scene();
	var camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 );
	//camera.position = {x: 0, y: 0, z: -10};

	var renderer = new THREE.WebGLRenderer();
	renderer.setSize( window.innerWidth, window.innerHeight );
	document.body.appendChild( renderer.domElement );

	camera.position.z = 5;
	function animate() {
		requestAnimationFrame( animate );
		// TODO: Call animation functions
		//Graphics.AnimateScene();
		renderer.render( scene, camera );
	}
	animate();

	function blocksChanged(event){
		var code = Blockly.JavaScript.workspaceToCode(workspacePlayground);
		console.log(code);
		Graphics.ClearScene(scene);
		Graphics.SceneFromCode(scene, code);
	}
	var workspacePlayground = Blockly.inject('blocklyDiv', {toolbox: document.getElementById('toolbox')});
	workspacePlayground.addChangeListener(blocksChanged);
</script>